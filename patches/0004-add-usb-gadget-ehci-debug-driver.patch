From dc1489ff32142d704192a304e09d06494659ea53 Mon Sep 17 00:00:00 2001
From: Alexander Couzens <lynxis@fe80.eu>
Date: Tue, 26 Apr 2016 03:17:25 +0200
Subject: [PATCH 4/4] add usb gadget ehci debug driver

This gadget driver allow you to debug other devices via EHCI Debug Port
capability.

Signed-off-by: Alexander Couzens <lynxis@fe80.eu>
---
 package/kernel/linux/modules/usb.mk | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/package/kernel/linux/modules/usb.mk b/package/kernel/linux/modules/usb.mk
index 8c5a2ab..7857d44 100644
--- a/package/kernel/linux/modules/usb.mk
+++ b/package/kernel/linux/modules/usb.mk
@@ -234,6 +234,23 @@ endef
 
 $(eval $(call KernelPackage,usb-lib-composite))
 
+define KernelPackage/usb-ehci-debug-gadget
+  TITLE:=USB EHCI debug port Gadget support
+  KCONFIG:=\
+        CONFIG_USB_G_DBGP \
+	CONFIG_USB_G_DBGP_SERIAL=y \
+	CONFIG_USB_G_DBGP_PRINTK=n
+  DEPENDS:=+kmod-usb-gadget +kmod-usb-lib-composite +kmod-usb-serial-gadget
+  FILES:=$(LINUX_DIR)/drivers/usb/gadget/legacy/g_dbgp.ko
+  AUTOLOAD:=$(call AutoLoad,52,g_dbgp)
+  $(call AddDepends/usb)
+endef
+
+define KernelPackage/usb-ehci-debug-gadget/description
+  Kernel support for USB EHCI debug port Gadget.
+endef
+
+$(eval $(call KernelPackage,usb-ehci-debug-gadget))
 
 define KernelPackage/usb-eth-gadget
   TITLE:=USB Ethernet Gadget support
-- 
2.8.0

